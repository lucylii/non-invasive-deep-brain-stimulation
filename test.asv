close all; clear all;

% we are gonna load in the data saved from analytical solution
load('R_H.mat'); 
dataL_H  = fliplr(dataR_H);
dataAM_H = (dataL_H + dataR_H) - abs(dataL_H - dataR_H); 
figure; plot(1:numel(dataL_H), dataL_H,...
             1:numel(dataR_H), dataR_H,...
             1:numel(dataR_H), dataAM_H,...
             'LineWidth', 3);
title('Unnormalized values')
grid; axis tight

% normalize them (max AM signal must be 1)
dataR_H  = dataR_H/max(dataAM_H);
dataL_H  = dataL_H/max(dataAM_H);
dataAM_H = dataAM_H/max(dataAM_H);
figure; plot(1:numel(dataL_H), dataL_H,...
             1:numel(dataR_H), dataR_H,...
             1:numel(dataR_H), dataAM_H,...
             'LineWidth', 3);
title('Unnormalized values')
grid; axis tight

%% Some explanation up to this point

% No we are gonna test what is the amplitude needed for the modulated
% signal to make the neuron spike. Then we multiply the normalized values
% with that value. The we check if the new values of the pure sinudoids
% elicit action potential near the electrodes!

% check the value -> 35 (each 1)

%% Simulation

% initializing simulation param
tend = 500;
fs   = 100;
dt   = 1/fs; % 0.01

% initialize stimulaiton current
I_stim1 = 17.5;     % nA 
freq1   = 1.0;    % 0.01 => 10 Hz

I_stim2 = 17.5;   % nA 
freq2   = 1.01;    % 0.01 => 10 Hz

I_stim3 = 0;   % nA 
freq3   = 1.02;    % 0.01 => 10 Hz

MHH( I_stim1, freq1, I_stim2, freq2, I_stim3, freq3, tend, dt );